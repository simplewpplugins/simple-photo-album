jQuery(function(o){var i;function e(){o("#gallery-metabox-list li").each(function(t){o(this).find("input:hidden").attr("name","_simpa_photos["+t+"]")})}function l(){o("#gallery-metabox-list").sortable({opacity:.6,stop:function(){e()}})}o(document).on("click","#simpa-album-cover-trigger",function(t){t.preventDefault(),i&&i.close(),(i=wp.media.frames.file_frame=wp.media({title:o(this).data("uploader-title"),button:{text:o(this).data("uploader-button-text")},multiple:!1})).on("select",function(){var t=o("#simpa-album-cover-metabox-container"),e=t.find(".image-preview"),l=t.find("#_album_cover");i.state().get("selection").map(function(t,i){t=t.toJSON(),l.val(t.id),e.html('<img src="'+t.sizes.medium.url+'" width="100%"/>')})}),i.open()}),o(document).on("click","a.photo-add",function(t){t.preventDefault(),i&&i.close(),(i=wp.media.frames.file_frame=wp.media({title:o(this).data("uploader-title"),button:{text:o(this).data("uploader-button-text")},multiple:!0})).on("select",function(){var e=o("#gallery-metabox-list li").index(o("#gallery-metabox-list li:last"));i.state().get("selection").map(function(t,i){t=t.toJSON(),index=e+(i+1),o("#gallery-metabox-list").append('<li><input type="hidden" name="_simpa_photos['+index+']" value="'+t.id+'"><img class="image-preview" src="'+t.sizes.thumbnail.url+'"><span class="controls"><a class="remove-image" href="#">&times;</a></span></li>')})}),l(),i.open()}),o(document).on("click","a.remove-image",function(t){t.preventDefault(),o(this).parents("li").animate({opacity:0},200,function(){o(this).remove(),e()})}),l()});